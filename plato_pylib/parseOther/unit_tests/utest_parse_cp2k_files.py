#!/usr/bin/python3

import itertools
import os
import sys
import unittest

import plato_pylib.parseOther.parse_cp2k_files as tCode

#Tests related to parsing of the output file (e.g. outfile.cpout in cp2k.sopt -o outfile.cpout *.inp)
class testCPoutParsing(unittest.TestCase):

	def setUp(self):
		self.fullFilePathA = createCP2KFullFileA() #hcp Mg with PBCs on
	def tearDown(self):
		os.remove( self.fullFilePathA )

	def testUnitCellParsing(self):
		expectedVolume = 46.369 #in angstroms
		expectedAngles = [90,90,120] #alpha,beta,gamma in degrees
		expectedLengths = [3.207, 3.207, 5.207] #a,b,c in angstroms

		actualUnitCell = tCode.parseCpout(self.fullFilePathA)["unitCell"]
		actualVolume = actualUnitCell.getVolume()
		actualLengths, actualAngles = actualUnitCell.getLattParamsList(), actualUnitCell.getLattAnglesList()

		self.assertAlmostEqual(expectedVolume,actualVolume, places=1)
		[self.assertAlmostEqual(exp,act) for exp,act in itertools.zip_longest(expectedAngles,actualAngles)]
		[self.assertAlmostEqual(exp,act) for exp,act in itertools.zip_longest(expectedLengths,actualLengths)]

	def testEnergyParsing(self):
		expectedEnergy = -1.57065744839809 * tCode.HART_TO_EV
		actualEnergy = tCode.parseCpout(self.fullFilePathA)["energy"] #Here for backwards compat really.
		otherTotalElectron = tCode.parseCpout(self.fullFilePathA)["energies"].electronicTotalE #Proper way to get electronic energy
		self.assertAlmostEqual(expectedEnergy, actualEnergy)
		self.assertAlmostEqual(expectedEnergy, otherTotalElectron)

	def testAtomsParsing(self):
		expectedNumbAtoms = 2
		actualNumbAtoms = tCode.parseCpout(self.fullFilePathA)["numbAtoms"]
		self.assertEqual(expectedNumbAtoms,actualNumbAtoms)

def createCP2KFullFileA():
	filePath = os.path.join( os.getcwd(), "full_file_hcp_mg.cpout" )
	fileStr = " DBCSR| Multiplication driver                                               BLAS\n DBCSR| Multrec recursion limit                                              512\n DBCSR| Multiplication stack size                                           1000\n DBCSR| Maximum elements for images                                    UNLIMITED\n DBCSR| Multiplicative factor virtual images                                   1\n DBCSR| Multiplication size stacks                                             3\n DBCSR| Number of 3D layers                                               SINGLE\n DBCSR| Use MPI memory allocation                                              T\n DBCSR| Use RMA algorithm                                                      F\n DBCSR| Use Communication thread                                               T\n DBCSR| Communication thread load                                             87\n\n\n  **** **** ******  **  PROGRAM STARTED AT               2018-09-13 10:45:39.061\n ***** ** ***  *** **   PROGRAM STARTED ON         cx1-138-14-1.cx1.hpc.ic.ac.uk\n **    ****   ******    PROGRAM STARTED BY                                 rf614\n ***** **    ** ** **   PROGRAM PROCESS ID                                 14076\n  **** **  *******  **  PROGRAM STARTED IN /tmp/pbs.1998026.cx1/workDir/cutoff_6\n                                           000\n\n CP2K| version string:                                          CP2K version 6.1\n CP2K| source code revision number:                                    svn:18464\n CP2K| cp2kflags: libint fftw3 parallel mpi3 scalapack has_no_shared_glibc max_c\n CP2K|            ontr=4 mkl\n CP2K| is freely available from                            https://www.cp2k.org/\n CP2K| Program compiled at                          Thu 12 Jul 13:52:12 BST 2018\n CP2K| Program compiled on                                  build-2.hpc.ic.ac.uk\n CP2K| Program compiled for                                   Linux-x86-64-intel\n CP2K| Data directory path                                   /tmp/cp2k/cp2k/data\n CP2K| Input file name                                    Mg_spd_1z_template.inp\n \n GLOBAL| Force Environment number                                              1\n GLOBAL| Basis set file name                                 TIGHT_BINDING_BASIS\n GLOBAL| Potential file name                                      GTH_POTENTIALS\n GLOBAL| MM Potential file name                                     MM_POTENTIAL\n GLOBAL| Coordinate file name                                      __STD_INPUT__\n GLOBAL| Method name                                                        CP2K\n GLOBAL| Project name                                                         Mg\n GLOBAL| Preferred FFT library                                             FFTW3\n GLOBAL| Preferred diagonalization lib.                                       SL\n GLOBAL| Run type                                                         ENERGY\n GLOBAL| All-to-all communication in single precision                          F\n GLOBAL| FFTs using library dependent lengths                                  F\n GLOBAL| Global print level                                               MEDIUM\n GLOBAL| Total number of message passing processes                            12\n GLOBAL| Number of threads for this process                                    1\n GLOBAL| This output is from process                                           0\n GLOBAL| CPU model name :  Intel(R) Xeon(R) CPU E5-2650 0 @ 2.00GHz\n\n MEMORY| system memory details [Kb]\n MEMORY|                        rank 0           min           max       average\n MEMORY| MemTotal            132001080     132001080     132001080     132001080\n MEMORY| MemFree              74114120      74114120      74114120      74114120\n MEMORY| Buffers                     0             0             0             0\n MEMORY| Cached               50686260      50686260      50686260      50686260\n MEMORY| Slab                  1372172       1372172       1372172       1372172\n MEMORY| SReclaimable          1244172       1244172       1244172       1244172\n MEMORY| MemLikelyFree       126044552     126044552     126044552     126044552\n\n\n *** Fundamental physical constants (SI units) ***\n\n *** Literature: B. J. Mohr and B. N. Taylor,\n ***             CODATA recommended values of the fundamental physical\n ***             constants: 2006, Web Version 5.1\n ***             http://physics.nist.gov/constants\n\n Speed of light in vacuum [m/s]                             2.99792458000000E+08\n Magnetic constant or permeability of vacuum [N/A**2]       1.25663706143592E-06\n Electric constant or permittivity of vacuum [F/m]          8.85418781762039E-12\n Planck constant (h) [J*s]                                  6.62606896000000E-34\n Planck constant (h-bar) [J*s]                              1.05457162825177E-34\n Elementary charge [C]                                      1.60217648700000E-19\n Electron mass [kg]                                         9.10938215000000E-31\n Electron g factor [ ]                                     -2.00231930436220E+00\n Proton mass [kg]                                           1.67262163700000E-27\n Fine-structure constant                                    7.29735253760000E-03\n Rydberg constant [1/m]                                     1.09737315685270E+07\n Avogadro constant [1/mol]                                  6.02214179000000E+23\n Boltzmann constant [J/K]                                   1.38065040000000E-23\n Atomic mass unit [kg]                                      1.66053878200000E-27\n Bohr radius [m]                                            5.29177208590000E-11\n\n *** Conversion factors ***\n\n [u] -> [a.u.]                                              1.82288848426455E+03\n [Angstrom] -> [Bohr] = [a.u.]                              1.88972613288564E+00\n [a.u.] = [Bohr] -> [Angstrom]                              5.29177208590000E-01\n [a.u.] -> [s]                                              2.41888432650478E-17\n [a.u.] -> [fs]                                             2.41888432650478E-02\n [a.u.] -> [J]                                              4.35974393937059E-18\n [a.u.] -> [N]                                              8.23872205491840E-08\n [a.u.] -> [K]                                              3.15774647902944E+05\n [a.u.] -> [kJ/mol]                                         2.62549961709828E+03\n [a.u.] -> [kcal/mol]                                       6.27509468713739E+02\n [a.u.] -> [Pa]                                             2.94210107994716E+13\n [a.u.] -> [bar]                                            2.94210107994716E+08\n [a.u.] -> [atm]                                            2.90362800883016E+08\n [a.u.] -> [eV]                                             2.72113838565563E+01\n [a.u.] -> [Hz]                                             6.57968392072181E+15\n [a.u.] -> [1/cm] (wave numbers)                            2.19474631370540E+05\n [a.u./Bohr**2] -> [1/cm]                                   5.14048714338585E+03\n \n\n CELL_TOP| Volume [angstrom^3]:                                           46.369\n CELL_TOP| Vector a [angstrom     3.207     0.000     0.000    |a| =       3.207\n CELL_TOP| Vector b [angstrom    -1.603     2.777     0.000    |b| =       3.207\n CELL_TOP| Vector c [angstrom     0.000     0.000     5.207    |c| =       5.207\n CELL_TOP| Angle (b,c), alpha [degree]:                                   90.000\n CELL_TOP| Angle (a,c), beta  [degree]:                                   90.000\n CELL_TOP| Angle (a,b), gamma [degree]:                                  120.000\n CELL_TOP| Numerically orthorhombic:                                          NO\n \n GENERATE|  Preliminary Number of Bonds generated:                             0\n GENERATE|  Achieved consistency in connectivity generation.\n\n CELL| Volume [angstrom^3]:                                               46.369\n CELL| Vector a [angstrom]:       3.207     0.000     0.000    |a| =       3.207\n CELL| Vector b [angstrom]:      -1.603     2.777     0.000    |b| =       3.207\n CELL| Vector c [angstrom]:       0.000     0.000     5.207    |c| =       5.207\n CELL| Angle (b,c), alpha [degree]:                                       90.000\n CELL| Angle (a,c), beta  [degree]:                                       90.000\n CELL| Angle (a,b), gamma [degree]:                                      120.000\n CELL| Numerically orthorhombic:                                              NO\n\n CELL_REF| Volume [angstrom^3]:                                           46.369\n CELL_REF| Vector a [angstrom     3.207     0.000     0.000    |a| =       3.207\n CELL_REF| Vector b [angstrom    -1.603     2.777     0.000    |b| =       3.207\n CELL_REF| Vector c [angstrom     0.000     0.000     5.207    |c| =       5.207\n CELL_REF| Angle (b,c), alpha [degree]:                                   90.000\n CELL_REF| Angle (a,c), beta  [degree]:                                   90.000\n CELL_REF| Angle (a,b), gamma [degree]:                                  120.000\n CELL_REF| Numerically orthorhombic:                                          NO\n\n *** WARNING in cryssym.F:163 :: Symmetry library SPGLIB not available ***\n\n\n *******************************************************************************\n                                    Kpoints\n *******************************************************************************\n BRILLOUIN| K-point scheme                                        Monkhorst-Pack\n BRILLOUIN| K-Point grid                                            10   10    6\n BRILLOUIN| Accuracy in Symmetry determination                      0.100000E-05\n BRILLOUIN| K-Point point group symmetrization                               OFF\n BRILLOUIN| Wavefunction type                                            COMPLEX\n BRILLOUIN| List of Kpoints [2 Pi/Bohr]                                      300\n BRILLOUIN| Number           Weight            X              Y              Z\n BRILLOUIN|     1           0.00333       -0.45000       -0.45000       -0.41667\n BRILLOUIN|     2           0.00333       -0.45000       -0.45000       -0.25000\n BRILLOUIN|     3           0.00333       -0.45000       -0.45000       -0.08333\n BRILLOUIN|     4           0.00333       -0.45000       -0.45000        0.08333\n BRILLOUIN|     5           0.00333       -0.45000       -0.45000        0.25000\n BRILLOUIN|     6           0.00333       -0.45000       -0.45000        0.41667\n BRILLOUIN|     7           0.00333       -0.45000       -0.35000       -0.41667\n BRILLOUIN|     8           0.00333       -0.45000       -0.35000       -0.25000\n BRILLOUIN|     9           0.00333       -0.45000       -0.35000       -0.08333\n BRILLOUIN|    10           0.00333       -0.45000       -0.35000        0.08333\n BRILLOUIN|    11           0.00333       -0.45000       -0.35000        0.25000\n BRILLOUIN|    12           0.00333       -0.45000       -0.35000        0.41667\n BRILLOUIN|    13           0.00333       -0.45000       -0.25000       -0.41667\n BRILLOUIN|    14           0.00333       -0.45000       -0.25000       -0.25000\n BRILLOUIN|    15           0.00333       -0.45000       -0.25000       -0.08333\n BRILLOUIN|    16           0.00333       -0.45000       -0.25000        0.08333\n BRILLOUIN|    17           0.00333       -0.45000       -0.25000        0.25000\n BRILLOUIN|    18           0.00333       -0.45000       -0.25000        0.41667\n BRILLOUIN|    19           0.00333       -0.45000       -0.15000       -0.41667\n BRILLOUIN|    20           0.00333       -0.45000       -0.15000       -0.25000\n BRILLOUIN|    21           0.00333       -0.45000       -0.15000       -0.08333\n BRILLOUIN|    22           0.00333       -0.45000       -0.15000        0.08333\n BRILLOUIN|    23           0.00333       -0.45000       -0.15000        0.25000\n BRILLOUIN|    24           0.00333       -0.45000       -0.15000        0.41667\n BRILLOUIN|    25           0.00333       -0.45000       -0.05000       -0.41667\n BRILLOUIN|    26           0.00333       -0.45000       -0.05000       -0.25000\n BRILLOUIN|    27           0.00333       -0.45000       -0.05000       -0.08333\n BRILLOUIN|    28           0.00333       -0.45000       -0.05000        0.08333\n BRILLOUIN|    29           0.00333       -0.45000       -0.05000        0.25000\n BRILLOUIN|    30           0.00333       -0.45000       -0.05000        0.41667\n BRILLOUIN|    31           0.00333       -0.45000        0.05000       -0.41667\n BRILLOUIN|    32           0.00333       -0.45000        0.05000       -0.25000\n BRILLOUIN|    33           0.00333       -0.45000        0.05000       -0.08333\n BRILLOUIN|    34           0.00333       -0.45000        0.05000        0.08333\n BRILLOUIN|    35           0.00333       -0.45000        0.05000        0.25000\n BRILLOUIN|    36           0.00333       -0.45000        0.05000        0.41667\n BRILLOUIN|    37           0.00333       -0.45000        0.15000       -0.41667\n BRILLOUIN|    38           0.00333       -0.45000        0.15000       -0.25000\n BRILLOUIN|    39           0.00333       -0.45000        0.15000       -0.08333\n BRILLOUIN|    40           0.00333       -0.45000        0.15000        0.08333\n BRILLOUIN|    41           0.00333       -0.45000        0.15000        0.25000\n BRILLOUIN|    42           0.00333       -0.45000        0.15000        0.41667\n BRILLOUIN|    43           0.00333       -0.45000        0.25000       -0.41667\n BRILLOUIN|    44           0.00333       -0.45000        0.25000       -0.25000\n BRILLOUIN|    45           0.00333       -0.45000        0.25000       -0.08333\n BRILLOUIN|    46           0.00333       -0.45000        0.25000        0.08333\n BRILLOUIN|    47           0.00333       -0.45000        0.25000        0.25000\n BRILLOUIN|    48           0.00333       -0.45000        0.25000        0.41667\n BRILLOUIN|    49           0.00333       -0.45000        0.35000       -0.41667\n BRILLOUIN|    50           0.00333       -0.45000        0.35000       -0.25000\n BRILLOUIN|    51           0.00333       -0.45000        0.35000       -0.08333\n BRILLOUIN|    52           0.00333       -0.45000        0.35000        0.08333\n BRILLOUIN|    53           0.00333       -0.45000        0.35000        0.25000\n BRILLOUIN|    54           0.00333       -0.45000        0.35000        0.41667\n BRILLOUIN|    55           0.00333       -0.45000        0.45000       -0.41667\n BRILLOUIN|    56           0.00333       -0.45000        0.45000       -0.25000\n BRILLOUIN|    57           0.00333       -0.45000        0.45000       -0.08333\n BRILLOUIN|    58           0.00333       -0.45000        0.45000        0.08333\n BRILLOUIN|    59           0.00333       -0.45000        0.45000        0.25000\n BRILLOUIN|    60           0.00333       -0.45000        0.45000        0.41667\n BRILLOUIN|    61           0.00333       -0.35000       -0.45000       -0.41667\n BRILLOUIN|    62           0.00333       -0.35000       -0.45000       -0.25000\n BRILLOUIN|    63           0.00333       -0.35000       -0.45000       -0.08333\n BRILLOUIN|    64           0.00333       -0.35000       -0.45000        0.08333\n BRILLOUIN|    65           0.00333       -0.35000       -0.45000        0.25000\n BRILLOUIN|    66           0.00333       -0.35000       -0.45000        0.41667\n BRILLOUIN|    67           0.00333       -0.35000       -0.35000       -0.41667\n BRILLOUIN|    68           0.00333       -0.35000       -0.35000       -0.25000\n BRILLOUIN|    69           0.00333       -0.35000       -0.35000       -0.08333\n BRILLOUIN|    70           0.00333       -0.35000       -0.35000        0.08333\n BRILLOUIN|    71           0.00333       -0.35000       -0.35000        0.25000\n BRILLOUIN|    72           0.00333       -0.35000       -0.35000        0.41667\n BRILLOUIN|    73           0.00333       -0.35000       -0.25000       -0.41667\n BRILLOUIN|    74           0.00333       -0.35000       -0.25000       -0.25000\n BRILLOUIN|    75           0.00333       -0.35000       -0.25000       -0.08333\n BRILLOUIN|    76           0.00333       -0.35000       -0.25000        0.08333\n BRILLOUIN|    77           0.00333       -0.35000       -0.25000        0.25000\n BRILLOUIN|    78           0.00333       -0.35000       -0.25000        0.41667\n BRILLOUIN|    79           0.00333       -0.35000       -0.15000       -0.41667\n BRILLOUIN|    80           0.00333       -0.35000       -0.15000       -0.25000\n BRILLOUIN|    81           0.00333       -0.35000       -0.15000       -0.08333\n BRILLOUIN|    82           0.00333       -0.35000       -0.15000        0.08333\n BRILLOUIN|    83           0.00333       -0.35000       -0.15000        0.25000\n BRILLOUIN|    84           0.00333       -0.35000       -0.15000        0.41667\n BRILLOUIN|    85           0.00333       -0.35000       -0.05000       -0.41667\n BRILLOUIN|    86           0.00333       -0.35000       -0.05000       -0.25000\n BRILLOUIN|    87           0.00333       -0.35000       -0.05000       -0.08333\n BRILLOUIN|    88           0.00333       -0.35000       -0.05000        0.08333\n BRILLOUIN|    89           0.00333       -0.35000       -0.05000        0.25000\n BRILLOUIN|    90           0.00333       -0.35000       -0.05000        0.41667\n BRILLOUIN|    91           0.00333       -0.35000        0.05000       -0.41667\n BRILLOUIN|    92           0.00333       -0.35000        0.05000       -0.25000\n BRILLOUIN|    93           0.00333       -0.35000        0.05000       -0.08333\n BRILLOUIN|    94           0.00333       -0.35000        0.05000        0.08333\n BRILLOUIN|    95           0.00333       -0.35000        0.05000        0.25000\n BRILLOUIN|    96           0.00333       -0.35000        0.05000        0.41667\n BRILLOUIN|    97           0.00333       -0.35000        0.15000       -0.41667\n BRILLOUIN|    98           0.00333       -0.35000        0.15000       -0.25000\n BRILLOUIN|    99           0.00333       -0.35000        0.15000       -0.08333\n BRILLOUIN|   100           0.00333       -0.35000        0.15000        0.08333\n BRILLOUIN|   101           0.00333       -0.35000        0.15000        0.25000\n BRILLOUIN|   102           0.00333       -0.35000        0.15000        0.41667\n BRILLOUIN|   103           0.00333       -0.35000        0.25000       -0.41667\n BRILLOUIN|   104           0.00333       -0.35000        0.25000       -0.25000\n BRILLOUIN|   105           0.00333       -0.35000        0.25000       -0.08333\n BRILLOUIN|   106           0.00333       -0.35000        0.25000        0.08333\n BRILLOUIN|   107           0.00333       -0.35000        0.25000        0.25000\n BRILLOUIN|   108           0.00333       -0.35000        0.25000        0.41667\n BRILLOUIN|   109           0.00333       -0.35000        0.35000       -0.41667\n BRILLOUIN|   110           0.00333       -0.35000        0.35000       -0.25000\n BRILLOUIN|   111           0.00333       -0.35000        0.35000       -0.08333\n BRILLOUIN|   112           0.00333       -0.35000        0.35000        0.08333\n BRILLOUIN|   113           0.00333       -0.35000        0.35000        0.25000\n BRILLOUIN|   114           0.00333       -0.35000        0.35000        0.41667\n BRILLOUIN|   115           0.00333       -0.35000        0.45000       -0.41667\n BRILLOUIN|   116           0.00333       -0.35000        0.45000       -0.25000\n BRILLOUIN|   117           0.00333       -0.35000        0.45000       -0.08333\n BRILLOUIN|   118           0.00333       -0.35000        0.45000        0.08333\n BRILLOUIN|   119           0.00333       -0.35000        0.45000        0.25000\n BRILLOUIN|   120           0.00333       -0.35000        0.45000        0.41667\n BRILLOUIN|   121           0.00333       -0.25000       -0.45000       -0.41667\n BRILLOUIN|   122           0.00333       -0.25000       -0.45000       -0.25000\n BRILLOUIN|   123           0.00333       -0.25000       -0.45000       -0.08333\n BRILLOUIN|   124           0.00333       -0.25000       -0.45000        0.08333\n BRILLOUIN|   125           0.00333       -0.25000       -0.45000        0.25000\n BRILLOUIN|   126           0.00333       -0.25000       -0.45000        0.41667\n BRILLOUIN|   127           0.00333       -0.25000       -0.35000       -0.41667\n BRILLOUIN|   128           0.00333       -0.25000       -0.35000       -0.25000\n BRILLOUIN|   129           0.00333       -0.25000       -0.35000       -0.08333\n BRILLOUIN|   130           0.00333       -0.25000       -0.35000        0.08333\n BRILLOUIN|   131           0.00333       -0.25000       -0.35000        0.25000\n BRILLOUIN|   132           0.00333       -0.25000       -0.35000        0.41667\n BRILLOUIN|   133           0.00333       -0.25000       -0.25000       -0.41667\n BRILLOUIN|   134           0.00333       -0.25000       -0.25000       -0.25000\n BRILLOUIN|   135           0.00333       -0.25000       -0.25000       -0.08333\n BRILLOUIN|   136           0.00333       -0.25000       -0.25000        0.08333\n BRILLOUIN|   137           0.00333       -0.25000       -0.25000        0.25000\n BRILLOUIN|   138           0.00333       -0.25000       -0.25000        0.41667\n BRILLOUIN|   139           0.00333       -0.25000       -0.15000       -0.41667\n BRILLOUIN|   140           0.00333       -0.25000       -0.15000       -0.25000\n BRILLOUIN|   141           0.00333       -0.25000       -0.15000       -0.08333\n BRILLOUIN|   142           0.00333       -0.25000       -0.15000        0.08333\n BRILLOUIN|   143           0.00333       -0.25000       -0.15000        0.25000\n BRILLOUIN|   144           0.00333       -0.25000       -0.15000        0.41667\n BRILLOUIN|   145           0.00333       -0.25000       -0.05000       -0.41667\n BRILLOUIN|   146           0.00333       -0.25000       -0.05000       -0.25000\n BRILLOUIN|   147           0.00333       -0.25000       -0.05000       -0.08333\n BRILLOUIN|   148           0.00333       -0.25000       -0.05000        0.08333\n BRILLOUIN|   149           0.00333       -0.25000       -0.05000        0.25000\n BRILLOUIN|   150           0.00333       -0.25000       -0.05000        0.41667\n BRILLOUIN|   151           0.00333       -0.25000        0.05000       -0.41667\n BRILLOUIN|   152           0.00333       -0.25000        0.05000       -0.25000\n BRILLOUIN|   153           0.00333       -0.25000        0.05000       -0.08333\n BRILLOUIN|   154           0.00333       -0.25000        0.05000        0.08333\n BRILLOUIN|   155           0.00333       -0.25000        0.05000        0.25000\n BRILLOUIN|   156           0.00333       -0.25000        0.05000        0.41667\n BRILLOUIN|   157           0.00333       -0.25000        0.15000       -0.41667\n BRILLOUIN|   158           0.00333       -0.25000        0.15000       -0.25000\n BRILLOUIN|   159           0.00333       -0.25000        0.15000       -0.08333\n BRILLOUIN|   160           0.00333       -0.25000        0.15000        0.08333\n BRILLOUIN|   161           0.00333       -0.25000        0.15000        0.25000\n BRILLOUIN|   162           0.00333       -0.25000        0.15000        0.41667\n BRILLOUIN|   163           0.00333       -0.25000        0.25000       -0.41667\n BRILLOUIN|   164           0.00333       -0.25000        0.25000       -0.25000\n BRILLOUIN|   165           0.00333       -0.25000        0.25000       -0.08333\n BRILLOUIN|   166           0.00333       -0.25000        0.25000        0.08333\n BRILLOUIN|   167           0.00333       -0.25000        0.25000        0.25000\n BRILLOUIN|   168           0.00333       -0.25000        0.25000        0.41667\n BRILLOUIN|   169           0.00333       -0.25000        0.35000       -0.41667\n BRILLOUIN|   170           0.00333       -0.25000        0.35000       -0.25000\n BRILLOUIN|   171           0.00333       -0.25000        0.35000       -0.08333\n BRILLOUIN|   172           0.00333       -0.25000        0.35000        0.08333\n BRILLOUIN|   173           0.00333       -0.25000        0.35000        0.25000\n BRILLOUIN|   174           0.00333       -0.25000        0.35000        0.41667\n BRILLOUIN|   175           0.00333       -0.25000        0.45000       -0.41667\n BRILLOUIN|   176           0.00333       -0.25000        0.45000       -0.25000\n BRILLOUIN|   177           0.00333       -0.25000        0.45000       -0.08333\n BRILLOUIN|   178           0.00333       -0.25000        0.45000        0.08333\n BRILLOUIN|   179           0.00333       -0.25000        0.45000        0.25000\n BRILLOUIN|   180           0.00333       -0.25000        0.45000        0.41667\n BRILLOUIN|   181           0.00333       -0.15000       -0.45000       -0.41667\n BRILLOUIN|   182           0.00333       -0.15000       -0.45000       -0.25000\n BRILLOUIN|   183           0.00333       -0.15000       -0.45000       -0.08333\n BRILLOUIN|   184           0.00333       -0.15000       -0.45000        0.08333\n BRILLOUIN|   185           0.00333       -0.15000       -0.45000        0.25000\n BRILLOUIN|   186           0.00333       -0.15000       -0.45000        0.41667\n BRILLOUIN|   187           0.00333       -0.15000       -0.35000       -0.41667\n BRILLOUIN|   188           0.00333       -0.15000       -0.35000       -0.25000\n BRILLOUIN|   189           0.00333       -0.15000       -0.35000       -0.08333\n BRILLOUIN|   190           0.00333       -0.15000       -0.35000        0.08333\n BRILLOUIN|   191           0.00333       -0.15000       -0.35000        0.25000\n BRILLOUIN|   192           0.00333       -0.15000       -0.35000        0.41667\n BRILLOUIN|   193           0.00333       -0.15000       -0.25000       -0.41667\n BRILLOUIN|   194           0.00333       -0.15000       -0.25000       -0.25000\n BRILLOUIN|   195           0.00333       -0.15000       -0.25000       -0.08333\n BRILLOUIN|   196           0.00333       -0.15000       -0.25000        0.08333\n BRILLOUIN|   197           0.00333       -0.15000       -0.25000        0.25000\n BRILLOUIN|   198           0.00333       -0.15000       -0.25000        0.41667\n BRILLOUIN|   199           0.00333       -0.15000       -0.15000       -0.41667\n BRILLOUIN|   200           0.00333       -0.15000       -0.15000       -0.25000\n BRILLOUIN|   201           0.00333       -0.15000       -0.15000       -0.08333\n BRILLOUIN|   202           0.00333       -0.15000       -0.15000        0.08333\n BRILLOUIN|   203           0.00333       -0.15000       -0.15000        0.25000\n BRILLOUIN|   204           0.00333       -0.15000       -0.15000        0.41667\n BRILLOUIN|   205           0.00333       -0.15000       -0.05000       -0.41667\n BRILLOUIN|   206           0.00333       -0.15000       -0.05000       -0.25000\n BRILLOUIN|   207           0.00333       -0.15000       -0.05000       -0.08333\n BRILLOUIN|   208           0.00333       -0.15000       -0.05000        0.08333\n BRILLOUIN|   209           0.00333       -0.15000       -0.05000        0.25000\n BRILLOUIN|   210           0.00333       -0.15000       -0.05000        0.41667\n BRILLOUIN|   211           0.00333       -0.15000        0.05000       -0.41667\n BRILLOUIN|   212           0.00333       -0.15000        0.05000       -0.25000\n BRILLOUIN|   213           0.00333       -0.15000        0.05000       -0.08333\n BRILLOUIN|   214           0.00333       -0.15000        0.05000        0.08333\n BRILLOUIN|   215           0.00333       -0.15000        0.05000        0.25000\n BRILLOUIN|   216           0.00333       -0.15000        0.05000        0.41667\n BRILLOUIN|   217           0.00333       -0.15000        0.15000       -0.41667\n BRILLOUIN|   218           0.00333       -0.15000        0.15000       -0.25000\n BRILLOUIN|   219           0.00333       -0.15000        0.15000       -0.08333\n BRILLOUIN|   220           0.00333       -0.15000        0.15000        0.08333\n BRILLOUIN|   221           0.00333       -0.15000        0.15000        0.25000\n BRILLOUIN|   222           0.00333       -0.15000        0.15000        0.41667\n BRILLOUIN|   223           0.00333       -0.15000        0.25000       -0.41667\n BRILLOUIN|   224           0.00333       -0.15000        0.25000       -0.25000\n BRILLOUIN|   225           0.00333       -0.15000        0.25000       -0.08333\n BRILLOUIN|   226           0.00333       -0.15000        0.25000        0.08333\n BRILLOUIN|   227           0.00333       -0.15000        0.25000        0.25000\n BRILLOUIN|   228           0.00333       -0.15000        0.25000        0.41667\n BRILLOUIN|   229           0.00333       -0.15000        0.35000       -0.41667\n BRILLOUIN|   230           0.00333       -0.15000        0.35000       -0.25000\n BRILLOUIN|   231           0.00333       -0.15000        0.35000       -0.08333\n BRILLOUIN|   232           0.00333       -0.15000        0.35000        0.08333\n BRILLOUIN|   233           0.00333       -0.15000        0.35000        0.25000\n BRILLOUIN|   234           0.00333       -0.15000        0.35000        0.41667\n BRILLOUIN|   235           0.00333       -0.15000        0.45000       -0.41667\n BRILLOUIN|   236           0.00333       -0.15000        0.45000       -0.25000\n BRILLOUIN|   237           0.00333       -0.15000        0.45000       -0.08333\n BRILLOUIN|   238           0.00333       -0.15000        0.45000        0.08333\n BRILLOUIN|   239           0.00333       -0.15000        0.45000        0.25000\n BRILLOUIN|   240           0.00333       -0.15000        0.45000        0.41667\n BRILLOUIN|   241           0.00333       -0.05000       -0.45000       -0.41667\n BRILLOUIN|   242           0.00333       -0.05000       -0.45000       -0.25000\n BRILLOUIN|   243           0.00333       -0.05000       -0.45000       -0.08333\n BRILLOUIN|   244           0.00333       -0.05000       -0.45000        0.08333\n BRILLOUIN|   245           0.00333       -0.05000       -0.45000        0.25000\n BRILLOUIN|   246           0.00333       -0.05000       -0.45000        0.41667\n BRILLOUIN|   247           0.00333       -0.05000       -0.35000       -0.41667\n BRILLOUIN|   248           0.00333       -0.05000       -0.35000       -0.25000\n BRILLOUIN|   249           0.00333       -0.05000       -0.35000       -0.08333\n BRILLOUIN|   250           0.00333       -0.05000       -0.35000        0.08333\n BRILLOUIN|   251           0.00333       -0.05000       -0.35000        0.25000\n BRILLOUIN|   252           0.00333       -0.05000       -0.35000        0.41667\n BRILLOUIN|   253           0.00333       -0.05000       -0.25000       -0.41667\n BRILLOUIN|   254           0.00333       -0.05000       -0.25000       -0.25000\n BRILLOUIN|   255           0.00333       -0.05000       -0.25000       -0.08333\n BRILLOUIN|   256           0.00333       -0.05000       -0.25000        0.08333\n BRILLOUIN|   257           0.00333       -0.05000       -0.25000        0.25000\n BRILLOUIN|   258           0.00333       -0.05000       -0.25000        0.41667\n BRILLOUIN|   259           0.00333       -0.05000       -0.15000       -0.41667\n BRILLOUIN|   260           0.00333       -0.05000       -0.15000       -0.25000\n BRILLOUIN|   261           0.00333       -0.05000       -0.15000       -0.08333\n BRILLOUIN|   262           0.00333       -0.05000       -0.15000        0.08333\n BRILLOUIN|   263           0.00333       -0.05000       -0.15000        0.25000\n BRILLOUIN|   264           0.00333       -0.05000       -0.15000        0.41667\n BRILLOUIN|   265           0.00333       -0.05000       -0.05000       -0.41667\n BRILLOUIN|   266           0.00333       -0.05000       -0.05000       -0.25000\n BRILLOUIN|   267           0.00333       -0.05000       -0.05000       -0.08333\n BRILLOUIN|   268           0.00333       -0.05000       -0.05000        0.08333\n BRILLOUIN|   269           0.00333       -0.05000       -0.05000        0.25000\n BRILLOUIN|   270           0.00333       -0.05000       -0.05000        0.41667\n BRILLOUIN|   271           0.00333       -0.05000        0.05000       -0.41667\n BRILLOUIN|   272           0.00333       -0.05000        0.05000       -0.25000\n BRILLOUIN|   273           0.00333       -0.05000        0.05000       -0.08333\n BRILLOUIN|   274           0.00333       -0.05000        0.05000        0.08333\n BRILLOUIN|   275           0.00333       -0.05000        0.05000        0.25000\n BRILLOUIN|   276           0.00333       -0.05000        0.05000        0.41667\n BRILLOUIN|   277           0.00333       -0.05000        0.15000       -0.41667\n BRILLOUIN|   278           0.00333       -0.05000        0.15000       -0.25000\n BRILLOUIN|   279           0.00333       -0.05000        0.15000       -0.08333\n BRILLOUIN|   280           0.00333       -0.05000        0.15000        0.08333\n BRILLOUIN|   281           0.00333       -0.05000        0.15000        0.25000\n BRILLOUIN|   282           0.00333       -0.05000        0.15000        0.41667\n BRILLOUIN|   283           0.00333       -0.05000        0.25000       -0.41667\n BRILLOUIN|   284           0.00333       -0.05000        0.25000       -0.25000\n BRILLOUIN|   285           0.00333       -0.05000        0.25000       -0.08333\n BRILLOUIN|   286           0.00333       -0.05000        0.25000        0.08333\n BRILLOUIN|   287           0.00333       -0.05000        0.25000        0.25000\n BRILLOUIN|   288           0.00333       -0.05000        0.25000        0.41667\n BRILLOUIN|   289           0.00333       -0.05000        0.35000       -0.41667\n BRILLOUIN|   290           0.00333       -0.05000        0.35000       -0.25000\n BRILLOUIN|   291           0.00333       -0.05000        0.35000       -0.08333\n BRILLOUIN|   292           0.00333       -0.05000        0.35000        0.08333\n BRILLOUIN|   293           0.00333       -0.05000        0.35000        0.25000\n BRILLOUIN|   294           0.00333       -0.05000        0.35000        0.41667\n BRILLOUIN|   295           0.00333       -0.05000        0.45000       -0.41667\n BRILLOUIN|   296           0.00333       -0.05000        0.45000       -0.25000\n BRILLOUIN|   297           0.00333       -0.05000        0.45000       -0.08333\n BRILLOUIN|   298           0.00333       -0.05000        0.45000        0.08333\n BRILLOUIN|   299           0.00333       -0.05000        0.45000        0.25000\n BRILLOUIN|   300           0.00333       -0.05000        0.45000        0.41667\n *******************************************************************************\n\n *******************************************************************************\n *******************************************************************************\n **                                                                           **\n **     #####                         ##              ##                      **\n **    ##   ##            ##          ##              ##                      **\n **   ##     ##                       ##            ######                    **\n **   ##     ##  ##   ##  ##   #####  ##  ##   ####   ##    #####    #####    **\n **   ##     ##  ##   ##  ##  ##      ## ##   ##      ##   ##   ##  ##   ##   **\n **   ##  ## ##  ##   ##  ##  ##      ####     ###    ##   ######   ######    **\n **    ##  ###   ##   ##  ##  ##      ## ##      ##   ##   ##       ##        **\n **     #######   #####   ##   #####  ##  ##  ####    ##    #####   ##        **\n **           ##                                                    ##        **\n **                                                                           **\n **                                                ... make the atoms dance   **\n **                                                                           **\n **            Copyright (C) by CP2K developers group (2000 - 2018)           **\n **                                                                           **\n *******************************************************************************\n\n DFT| Spin restricted Kohn-Sham (RKS) calculation                            RKS\n DFT| Multiplicity                                                             1\n DFT| Number of spin states                                                    1\n DFT| Charge                                                                   0\n DFT| Self-interaction correction (SIC)                                       NO\n DFT| Cutoffs: density                                              1.000000E-10\n DFT|          gradient                                             1.000000E-10\n DFT|          tau                                                  1.000000E-10\n DFT|          cutoff_smoothing_range                               0.000000E+00\n DFT| XC density smoothing                                                  NONE\n DFT| XC derivatives                                                          PW\n FUNCTIONAL| ROUTINE=NEW\n FUNCTIONAL| PBE:\n FUNCTIONAL| J.P.Perdew, K.Burke, M.Ernzerhof, Phys. Rev. Letter, vol. 77, n 18,\n FUNCTIONAL|  pp. 3865-3868, (1996){spin unpolarized}                           \n\n QS| Method:                                                                 GPW\n QS| Density plane wave grid type                        NON-SPHERICAL FULLSPACE\n QS| Number of grid levels:                                                    4\n QS| Density cutoff [a.u.]:                                                220.5\n QS| Multi grid cutoff [a.u.]: 1) grid level                               220.5\n QS|                           2) grid level                                73.5\n QS|                           3) grid level                                24.5\n QS|                           4) grid level                                 8.2\n QS| Grid level progression factor:                                          3.0\n QS| Relative density cutoff [a.u.]:                                     18374.7\n QS| Consistent realspace mapping and integration \n QS| Interaction thresholds: eps_pgf_orb:                                1.0E-05\n QS|                         eps_filter_matrix:                          0.0E+00\n QS|                         eps_core_charge:                            1.0E-12\n QS|                         eps_rho_gspace:                             1.0E-10\n QS|                         eps_rho_rspace:                             1.0E-10\n QS|                         eps_gvg_rspace:                             1.0E-05\n QS|                         eps_ppl:                                    1.0E-02\n QS|                         eps_ppnl:                                   1.0E-07\n\n\n ATOMIC KIND INFORMATION\n\n  1. Atomic kind: Mg                                    Number of atoms:       2\n\n     Orbital Basis Set                               SPD-1Z-14-14-14-constrained\n\n       Number of orbital shell sets:                                           3\n       Number of orbital shells:                                               3\n       Number of primitive Cartesian functions:                               42\n       Number of Cartesian basis functions:                                   10\n       Number of spherical basis functions:                                    9\n       Norm type:                                                              2\n\n       Normalised Cartesian orbitals:\n\n                        Set   Shell   Orbital            Exponent    Coefficient\n\n                          1       1    3s                0.211334       1.477450\n                                                         0.263508      -2.000027\n                                                         0.328563      -0.343831\n                                                         0.409678       2.000027\n                                                         0.510819      -0.479560\n                                                         0.636930      -1.363869\n                                                         0.794175       0.458932\n                                                         0.990240       0.811588\n                                                         1.234710      -0.330687\n                                                         1.539530      -0.599919\n                                                         1.919610       0.255446\n                                                         2.393530       0.389734\n                                                         2.984440      -0.353964\n                                                         3.721230       0.081129\n\n                          2       1    3px               0.228352       1.086738\n                                                         0.289625      -1.999848\n                                                         0.401779       1.952662\n                                                         0.568835      -1.204299\n                                                         0.569196      -0.285228\n                                                         0.859259       0.965738\n                                                         1.263320      -0.701610\n                                                         1.705140       0.378680\n                                                         2.237760       0.038726\n                                                         2.960640      -0.316935\n                                                         4.023710       0.428984\n                                                         5.407310      -0.329659\n                                                         7.196990       0.133456\n                                                         9.587470      -0.022141\n                          2       1    3py               0.228352       1.086738\n                                                         0.289625      -1.999848\n                                                         0.401779       1.952662\n                                                         0.568835      -1.204299\n                                                         0.569196      -0.285228\n                                                         0.859259       0.965738\n                                                         1.263320      -0.701610\n                                                         1.705140       0.378680\n                                                         2.237760       0.038726\n                                                         2.960640      -0.316935\n                                                         4.023710       0.428984\n                                                         5.407310      -0.329659\n                                                         7.196990       0.133456\n                                                         9.587470      -0.022141\n                          2       1    3pz               0.228352       1.086738\n                                                         0.289625      -1.999848\n                                                         0.401779       1.952662\n                                                         0.568835      -1.204299\n                                                         0.569196      -0.285228\n                                                         0.859259       0.965738\n                                                         1.263320      -0.701610\n                                                         1.705140       0.378680\n                                                         2.237760       0.038726\n                                                         2.960640      -0.316935\n                                                         4.023710       0.428984\n                                                         5.407310      -0.329659\n                                                         7.196990       0.133456\n                                                         9.587470      -0.022141\n\n                          3       1    3dx2              0.238188       0.888463\n                                                         0.268929      -1.492528\n                                                         0.307376       0.706661\n                                                         1.729730       0.293067\n                                                         2.119890      -0.414806\n                                                         2.793100       0.204577\n                                                         6.883380      -0.056976\n                                                         9.807220       0.057477\n                                                        13.505700      -0.030453\n                                                        18.244300       0.007665\n                                                        39.342200      -0.000264\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n                          3       1    3dxy              0.238188       1.538864\n                                                         0.268929      -2.585134\n                                                         0.307376       1.223972\n                                                         1.729730       0.507606\n                                                         2.119890      -0.718466\n                                                         2.793100       0.354338\n                                                         6.883380      -0.098686\n                                                         9.807220       0.099553\n                                                        13.505700      -0.052746\n                                                        18.244300       0.013276\n                                                        39.342200      -0.000458\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n                          3       1    3dxz              0.238188       1.538864\n                                                         0.268929      -2.585134\n                                                         0.307376       1.223972\n                                                         1.729730       0.507606\n                                                         2.119890      -0.718466\n                                                         2.793100       0.354338\n                                                         6.883380      -0.098686\n                                                         9.807220       0.099553\n                                                        13.505700      -0.052746\n                                                        18.244300       0.013276\n                                                        39.342200      -0.000458\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n                          3       1    3dy2              0.238188       0.888463\n                                                         0.268929      -1.492528\n                                                         0.307376       0.706661\n                                                         1.729730       0.293067\n                                                         2.119890      -0.414806\n                                                         2.793100       0.204577\n                                                         6.883380      -0.056976\n                                                         9.807220       0.057477\n                                                        13.505700      -0.030453\n                                                        18.244300       0.007665\n                                                        39.342200      -0.000264\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n                          3       1    3dyz              0.238188       1.538864\n                                                         0.268929      -2.585134\n                                                         0.307376       1.223972\n                                                         1.729730       0.507606\n                                                         2.119890      -0.718466\n                                                         2.793100       0.354338\n                                                         6.883380      -0.098686\n                                                         9.807220       0.099553\n                                                        13.505700      -0.052746\n                                                        18.244300       0.013276\n                                                        39.342200      -0.000458\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n                          3       1    3dz2              0.238188       0.888463\n                                                         0.268929      -1.492528\n                                                         0.307376       0.706661\n                                                         1.729730       0.293067\n                                                         2.119890      -0.414806\n                                                         2.793100       0.204577\n                                                         6.883380      -0.056976\n                                                         9.807220       0.057477\n                                                        13.505700      -0.030453\n                                                        18.244300       0.007665\n                                                        39.342200      -0.000264\n                                                       122.198000       0.000000\n                                                       310.401000       0.000000\n                                                       526.124000       0.000000\n\n     GTH Potential information for                                    GTH-PBE-q2\n\n       Description:                       Goedecker-Teter-Hutter pseudopotential\n                                           Goedecker et al., PRB 54, 1703 (1996)\n                                          Hartwigsen et al., PRB 58, 3641 (1998)\n                                                      Krack, TCA 114, 145 (2005)\n\n       Gaussian exponent of the core charge distribution:               1.502029\n       Electronic configuration (s p d ...):                                   2\n\n       Parameters of the local part of the GTH pseudopotential:\n\n                          rloc        C1          C2          C3          C4\n                        0.576960   -2.690407\n\n       Parameters of the non-local part of the GTH pseudopotential:\n\n                   l      r(l)      h(i,j,l)\n\n                   0    0.593924    3.503211   -0.716772\n                                   -0.716772    0.925348\n                   1    0.707157    0.831158\n\n\n MOLECULE KIND INFORMATION\n\n\n All atoms are their own molecule, skipping detailed information\n\n\n TOTAL NUMBERS AND MAXIMUM NUMBERS\n\n  Total number of            - Atomic kinds:                                   1\n                             - Atoms:                                          2\n                             - Shell sets:                                     6\n                             - Shells:                                         6\n                             - Primitive Cartesian functions:                 84\n                             - Cartesian basis functions:                     20\n                             - Spherical basis functions:                     18\n\n  Maximum angular momentum of- Orbital basis functions:                        2\n                             - Local part of the GTH pseudopotential:          0\n                             - Non-local part of the GTH pseudopotential:      2\n\n\n MODULE QUICKSTEP:  ATOMIC COORDINATES IN angstrom\n\n  Atom  Kind  Element       X           Y           Z          Z(eff)       Mass\n\n       1     1 Mg  12    0.000000    0.000000    0.000000      2.00      24.3050\n       2     1 Mg  12    0.000018    1.851434    2.603299      2.00      24.3050\n\n\n\n\n SCF PARAMETERS         Density guess:                                    ATOMIC\n                        --------------------------------------------------------\n                        max_scf:                                               1\n                        max_scf_history:                                       0\n                        max_diis:                                              4\n                        --------------------------------------------------------\n                        eps_scf:                                        1.00E-07\n                        eps_scf_history:                                0.00E+00\n                        eps_diis:                                       1.00E-01\n                        eps_eigval:                                     1.00E-05\n                        --------------------------------------------------------\n                        level_shift [a.u.]:                                 0.00\n                        added MOs                                         4    0\n                        --------------------------------------------------------\n                        Mixing method:                            BROYDEN_MIXING\n                                                charge density mixing in g-space\n                        --------------------------------------------------------\n                        Smear method:                                FERMI_DIRAC\n                        Electronic temperature [K]:                        157.9\n                        Electronic temperature [a.u.]:                  5.00E-04\n                        Accuracy threshold:                             1.00E-10\n                        --------------------------------------------------------\n                        No outer SCF\n\n PW_GRID| Information for grid number                                          1\n PW_GRID| Grid distributed over                                    12 processors\n PW_GRID| Real space group dimensions                                    12    1\n PW_GRID| the grid is blocked:                                                NO\n PW_GRID| Cutoff [a.u.]                                                    220.5\n PW_GRID| spherical cutoff:                                                   NO\n PW_GRID|   Bounds   1            -22      22                Points:          45\n PW_GRID|   Bounds   2            -22      22                Points:          45\n PW_GRID|   Bounds   3            -36      35                Points:          72\n PW_GRID| Volume element (a.u.^3)  0.2146E-02     Volume (a.u.^3)       312.9133\n PW_GRID| Grid span                                                    FULLSPACE\n PW_GRID|   Distribution                         Average         Max         Min\n PW_GRID|   G-Vectors                            12150.0       12150       12150\n PW_GRID|   G-Rays                                 270.0         270         270\n PW_GRID|   Real Space Points                    12150.0       12960        9720\n\n PW_GRID| Information for grid number                                          2\n PW_GRID| Grid distributed over                                    12 processors\n PW_GRID| Real space group dimensions                                    12    1\n PW_GRID| the grid is blocked:                                                NO\n PW_GRID| Cutoff [a.u.]                                                     73.5\n PW_GRID| spherical cutoff:                                                   NO\n PW_GRID|   Bounds   1            -12      11                Points:          24\n PW_GRID|   Bounds   2            -12      11                Points:          24\n PW_GRID|   Bounds   3            -20      19                Points:          40\n PW_GRID| Volume element (a.u.^3)  0.1358E-01     Volume (a.u.^3)       312.9133\n PW_GRID| Grid span                                                    FULLSPACE\n PW_GRID|   Distribution                         Average         Max         Min\n PW_GRID|   G-Vectors                             1920.0        1944        1896\n PW_GRID|   G-Rays                                  80.0          81          79\n PW_GRID|   Real Space Points                     1920.0        1920        1920\n\n PW_GRID| Information for grid number                                          3\n PW_GRID| Grid distributed over                                    12 processors\n PW_GRID| Real space group dimensions                                    12    1\n PW_GRID| the grid is blocked:                                                NO\n PW_GRID| Cutoff [a.u.]                                                     24.5\n PW_GRID| spherical cutoff:                                                   NO\n PW_GRID|   Bounds   1             -7       7                Points:          15\n PW_GRID|   Bounds   2             -7       7                Points:          15\n PW_GRID|   Bounds   3            -12      11                Points:          24\n PW_GRID| Volume element (a.u.^3)  0.5795E-01     Volume (a.u.^3)       312.9133\n PW_GRID| Grid span                                                    FULLSPACE\n PW_GRID|   Distribution                         Average         Max         Min\n PW_GRID|   G-Vectors                              450.0         495         405\n PW_GRID|   G-Rays                                  30.0          33          27\n PW_GRID|   Real Space Points                      450.0         720         360\n\n PW_GRID| Information for grid number                                          4\n PW_GRID| Grid distributed over                                    12 processors\n PW_GRID| Real space group dimensions                                     3    4\n PW_GRID| the grid is blocked:                                                NO\n PW_GRID| Cutoff [a.u.]                                                      8.2\n PW_GRID| spherical cutoff:                                                   NO\n PW_GRID|   Bounds   1             -4       3                Points:           8\n PW_GRID|   Bounds   2             -4       3                Points:           8\n PW_GRID|   Bounds   3             -7       7                Points:          15\n PW_GRID| Volume element (a.u.^3)  0.3260         Volume (a.u.^3)       312.9133\n PW_GRID| Grid span                                                    FULLSPACE\n PW_GRID|   Distribution                         Average         Max         Min\n PW_GRID|   G-Vectors                               80.0          96          72\n PW_GRID|   G-Rays                                  10.0          12           9\n PW_GRID|   Real Space Points                       80.0          90          60\n\n POISSON| Solver                                                        PERIODIC\n POISSON| Periodicity                                                        XYZ\n\n RS_GRID| Information for grid number                                          1\n RS_GRID|   Bounds   1            -22      22                Points:          45\n RS_GRID|   Bounds   2            -22      22                Points:          45\n RS_GRID|   Bounds   3            -36      35                Points:          72\n RS_GRID| Real space fully replicated\n RS_GRID| Group size                                                           1\n\n RS_GRID| Information for grid number                                          2\n RS_GRID|   Bounds   1            -12      11                Points:          24\n RS_GRID|   Bounds   2            -12      11                Points:          24\n RS_GRID|   Bounds   3            -20      19                Points:          40\n RS_GRID| Real space fully replicated\n RS_GRID| Group size                                                           1\n\n RS_GRID| Information for grid number                                          3\n RS_GRID|   Bounds   1             -7       7                Points:          15\n RS_GRID|   Bounds   2             -7       7                Points:          15\n RS_GRID|   Bounds   3            -12      11                Points:          24\n RS_GRID| Real space fully replicated\n RS_GRID| Group size                                                           1\n\n RS_GRID| Information for grid number                                          4\n RS_GRID|   Bounds   1             -4       3                Points:           8\n RS_GRID|   Bounds   2             -4       3                Points:           8\n RS_GRID|   Bounds   3             -7       7                Points:          15\n RS_GRID| Real space fully replicated\n RS_GRID| Group size                                                           1\n \n KPOINTS| Number of kpoint groups                                             12\n KPOINTS| Size of each kpoint group                                            1\n KPOINTS| Number of kpoints per group                                         25\n\n Number of electrons:                                                          4\n Number of occupied orbitals:                                                  2\n Number of molecular orbitals:                                                 6\n\n Number of orbital functions:                                                 18\n Number of independent orbital functions:                                     18\n\n Extrapolation method: initial_guess\n\n Atomic guess: The first density matrix is obtained in terms of atomic orbitals\n               and electronic configurations assigned to each atomic kind\n\n Guess for atomic kind: Mg\n\n Electronic structure\n    Total number of core electrons                                         10.00\n    Total number of valence electrons                                       2.00\n    Total number of electrons                                              12.00\n    Multiplicity                                                   not specified\n    S   [  2.00  2.00] 2.00\n    P   [  6.00]\n \n\n *******************************************************************************\n                  Iteration          Convergence                     Energy [au]\n *******************************************************************************\n                          1         0.00000                      -0.700690874452\n\n Energy components [Hartree]           Total Energy ::           -0.700690874452\n                                        Band Energy ::           -0.578994953267\n                                     Kinetic Energy ::            0.460313113317\n                                   Potential Energy ::           -1.161003987768\n                                      Virial (-V/T) ::            2.522204895279\n                                        Core Energy ::           -1.026242406922\n                                          XC Energy ::           -0.392219170285\n                                     Coulomb Energy ::            0.717770702756\n                       Total Pseudopotential Energy ::           -1.518980860266\n                       Local Pseudopotential Energy ::           -1.829807554801\n                    Nonlocal Pseudopotential Energy ::            0.310826694535\n                                        Confinement ::            0.324253400279\n\n Orbital energies  State     L     Occupation   Energy[a.u.]          Energy[eV]\n\n                       1     0          2.000      -0.289497           -7.877627\n \n\n Total Electron Density at R=0:                                         0.000012\n Re-scaling the density matrix to get the right number of electrons\n                  # Electrons              Trace(P)               Scaling factor\n                            4                 4.000                        1.000\n\n\n SCF WAVEFUNCTION OPTIMIZATION\n\n  Step     Update method      Time    Convergence         Total energy    Change\n  ------------------------------------------------------------------------------\n     1 NoMix/Diag. 0.40E+00   25.3     1.42568183        -1.5706574484 -1.57E+00\n\n  Leaving inner SCF loop after reaching     1 steps.\n\n\n  Electronic density on regular grids:         -4.0000000107       -0.0000000107\n  Core density on regular grids:                3.9999999968       -0.0000000032\n  Total charge density on r-space grids:       -0.0000000140\n  Total charge density g-space grids:          -0.0000000140\n\n  Overlap energy of the core charge distribution:               0.00000000000099\n  Self energy of the core charge distribution:                 -3.91146295972394\n  Core Hamiltonian energy:                                      1.40535228093216\n  Hartree energy:                                               1.80852671945613\n  Exchange-correlation energy:                                 -0.87307348906342\n  Electronic entropic energy:                                  -0.00001885713412\n  Fermi energy:                                                 0.10974707283205\n\n  Total energy:                                                -1.57065744839809\n\n *** WARNING in qs_scf.F:542 :: SCF run NOT converged ***\n\n\n !-----------------------------------------------------------------------------!\n                     Mulliken Population Analysis\n\n #  Atom  Element  Kind  Atomic population                           Net charge\n       1     Mg       1          2.000000                              0.000000\n       2     Mg       1          2.000000                             -0.000000\n # Total charge                              4.000000                 -0.000000\n\n !-----------------------------------------------------------------------------!\n\n !-----------------------------------------------------------------------------!\n                           Hirshfeld Charges\n\n  #Atom  Element  Kind  Ref Charge     Population                    Net charge\n      1       Mg     1       2.000          2.000                         0.000\n      2       Mg     1       2.000          2.000                        -0.000\n\n  Total Charge                                                           -0.000\n !-----------------------------------------------------------------------------!\n\n ENERGY| Total FORCE_EVAL ( QS ) energy (a.u.):               -1.570657448398086\n\n\n -------------------------------------------------------------------------------\n -                                                                             -\n -                                DBCSR STATISTICS                             -\n -                                                                             -\n -------------------------------------------------------------------------------\n COUNTER                                    TOTAL       BLAS       SMM       ACC\n flops inhomo. stacks                           0       0.0%      0.0%      0.0%\n flops total                         0.000000E+00       0.0%      0.0%      0.0%\n flops max/rank                      0.000000E+00       0.0%      0.0%      0.0%\n matmuls inhomo. stacks                         0       0.0%      0.0%      0.0%\n matmuls total                                  0       0.0%      0.0%      0.0%\n number of processed stacks                     0       0.0%      0.0%      0.0%\n average stack size                                     0.0       0.0       0.0\n marketing flops                     0.000000E+00\n -------------------------------------------------------------------------------\n \n MEMORY| Estimated peak process memory [MiB]                                  83\n\n -------------------------------------------------------------------------------\n ----                             MULTIGRID INFO                            ----\n -------------------------------------------------------------------------------\n count for grid        1:         122610          cutoff [a.u.]          220.50\n count for grid        2:              0          cutoff [a.u.]           73.50\n count for grid        3:              0          cutoff [a.u.]           24.50\n count for grid        4:              0          cutoff [a.u.]            8.17\n total gridlevel count  :         122610\n\n -------------------------------------------------------------------------------\n -                                                                             -\n -                         MESSAGE PASSING PERFORMANCE                         -\n -                                                                             -\n -------------------------------------------------------------------------------\n\n ROUTINE             CALLS      AVE VOLUME [Bytes]\n MP_Group             1288\n MP_Bcast            10830                  10561.\n MP_Allreduce          357                    212.\n MP_Sync                 4\n MP_Alltoall         25611\n MP_ISendRecv          165                  45840.\n MP_Wait              7515\n MP_ISend             7650                     66.\n MP_IRecv            12600                     43.\n MP_Recv               410                    432.\n -------------------------------------------------------------------------------\n\n\n -------------------------------------------------------------------------------\n -                                                                             -\n -                           R E F E R E N C E S                               -\n -                                                                             -\n -------------------------------------------------------------------------------\n \n CP2K version 6.1, the CP2K developers group (2018).\n CP2K is freely available from https://www.cp2k.org/ .\n\n Schuett, Ole; Messmer, Peter; Hutter, Juerg; VandeVondele, Joost. \n Electronic Structure Calculations on Graphics Processing Units, John Wiley & Sons, Ltd, 173-190 (2016). \n GPU-Accelerated Sparse Matrix-Matrix Multiplication for Linear Scaling Density Functional Theory.\n http://dx.doi.org/10.1002/9781118670712.ch8\n\n\n Borstnik, U; VandeVondele, J; Weber, V; Hutter, J. \n PARALLEL COMPUTING, 40 (5-6), 47-58 (2014). \n Sparse matrix multiplication: The distributed block-compressed sparse\n row library.\n http://dx.doi.org/10.1016/j.parco.2014.03.012\n\n\n Hutter, J; Iannuzzi, M; Schiffmann, F; VandeVondele, J. \n WILEY INTERDISCIPLINARY REVIEWS-COMPUTATIONAL MOLECULAR SCIENCE, 4 (1), 15-25 (2014). \n CP2K: atomistic simulations of condensed matter systems.\n http://dx.doi.org/10.1002/wcms.1159\n\n\n Krack, M. \n THEORETICAL CHEMISTRY ACCOUNTS, 114 (1-3), 145-152 (2005). \n Pseudopotentials for H to Kr optimized for gradient-corrected\n exchange-correlation functionals.\n http://dx.doi.org/10.1007/s00214-005-0655-y\n\n\n VandeVondele, J; Krack, M; Mohamed, F; Parrinello, M; Chassaing, T;\n Hutter, J. COMPUTER PHYSICS COMMUNICATIONS, 167 (2), 103-128 (2005). \n QUICKSTEP: Fast and accurate density functional calculations using a\n mixed Gaussian and plane waves approach.\n http://dx.doi.org/10.1016/j.cpc.2004.12.014\n\n\n Frigo, M; Johnson, SG. \n PROCEEDINGS OF THE IEEE, 93 (2), 216-231 (2005). \n The design and implementation of FFTW3.\n http://dx.doi.org/10.1109/JPROC.2004.840301\n\n\n Hartwigsen, C; Goedecker, S; Hutter, J. \n PHYSICAL REVIEW B, 58 (7), 3641-3662 (1998). \n Relativistic separable dual-space Gaussian pseudopotentials from H to Rn.\n http://dx.doi.org/10.1103/PhysRevB.58.3641\n\n\n Lippert, G; Hutter, J; Parrinello, M. \n MOLECULAR PHYSICS, 92 (3), 477-487 (1997). \n A hybrid Gaussian and plane wave density functional scheme.\n http://dx.doi.org/10.1080/002689797170220\n\n\n Perdew, JP; Burke, K; Ernzerhof, M. \n PHYSICAL REVIEW LETTERS, 77 (18), 3865-3868 (1996). \n Generalized gradient approximation made simple.\n http://dx.doi.org/10.1103/PhysRevLett.77.3865\n\n\n Goedecker, S; Teter, M; Hutter, J. \n PHYSICAL REVIEW B, 54 (3), 1703-1710 (1996). \n Separable dual-space Gaussian pseudopotentials.\n http://dx.doi.org/10.1103/PhysRevB.54.1703\n\n\n -------------------------------------------------------------------------------\n -                                                                             -\n -                                T I M I N G                                  -\n -                                                                             -\n -------------------------------------------------------------------------------\n SUBROUTINE                       CALLS  ASD         SELF TIME        TOTAL TIME\n                                MAXIMUM       AVERAGE  MAXIMUM  AVERAGE  MAXIMUM\n CP2K                                 1  1.0    0.005    0.011   58.640   58.641\n qs_energies                          1  2.0    0.001    0.001   58.547   58.547\n scf_env_do_scf                       1  3.0    0.000    0.000   57.776   57.777\n scf_env_do_scf_inner_loop            1  4.0    0.000    0.000   57.776   57.776\n rs_pw_transfer                      15  8.5    0.000    0.000   28.842   32.983\n mp_waitall_1                      7515  8.4   28.840   32.979   28.840   32.979\n rs_pw_transfer_RS2PW_230             4  8.2    0.005    0.005   28.837   32.977\n qs_rho_update_rho                    2  5.0    0.000    0.000   32.822   32.822\n calculate_rho_elec                   2  6.0    4.116   32.802   32.822   32.822\n density_rs2pw                        2  7.0    0.000    0.000   28.704   32.820\n qs_scf_new_mos_kp                    1  5.0    0.000    0.000   22.296   25.300\n do_general_diag_kp                   1  6.0    0.011    0.016   22.296   25.300\n dbcsr_desymmetrize_deep           2482  7.5    0.062    0.068   21.307   24.328\n mp_alltoall_i22                   4364  8.8   21.223   24.272   21.223   24.272\n qs_ks_update_qs_env                  1  5.0    0.000    0.000    3.048   23.932\n rebuild_ks_matrix                    1  6.0    0.000    0.000    3.046   23.929\n qs_ks_build_kohn_sham_matrix         1  7.0    0.000    0.001    3.046   23.929\n sum_up_and_integrate                 1  8.0    0.000    0.000    3.016   23.899\n integrate_v_rspace                   1  9.0    3.005   23.888    3.016   23.899\n -------------------------------------------------------------------------------\n\n The number of warnings for this run is : 2\n \n -------------------------------------------------------------------------------\n  **** **** ******  **  PROGRAM ENDED AT                 2018-09-13 10:46:37.882\n ***** ** ***  *** **   PROGRAM RAN ON             cx1-138-14-1.cx1.hpc.ic.ac.uk\n **    ****   ******    PROGRAM RAN BY                                     rf614\n ***** **    ** ** **   PROGRAM PROCESS ID                                 14076\n  **** **  *******  **  PROGRAM STOPPED IN /tmp/pbs.1998026.cx1/workDir/cutoff_6\n                                           000\n"


	with open(filePath,"wt") as f:
		f.write(fileStr)
	return filePath


if __name__ == '__main__':
	unittest.main()


